{% extends 'base.html' %} {% block content %}
<div class="max-w-3xl mx-auto px-4 py-6">
  <!-- Title & Back Button -->
  <div class="flex items-center justify-center mb-6 relative">
    <!-- Back Button -->
    <a
      href="{{ url_for('dashboard') }}"
      class="absolute left-0 bg-purple-100 text-purple-700 px-4 py-2 rounded-xl shadow hover:bg-purple-200 transition"
    >
      <i class="fas fa-arrow-left"></i>
    </a>

    <!-- Heading -->
    <h1 class="text-3xl font-bold text-purple-700">CSAT Practice</h1>
  </div>
  <!-- Topics List -->
  <div class="space-y-6">
    {% for topic, subtopics in csat_data.items() %}
    <div
      class="bg-white rounded-2xl shadow-md p-6 border border-purple-100 transition group"
    >
      <div
        class="flex items-center justify-between cursor-pointer"
        onclick="toggleDropdown('{{ loop.index }}')"
      >
        <div
          class="flex items-center space-x-4 text-purple-800 font-semibold text-lg"
        >
          <i
            class="fas fa-lightbulb text-xl group-hover:scale-110 transition-transform duration-200"
          ></i>
          <span>{{ topic }}</span>
        </div>
        <i
          class="fas fa-chevron-down text-gray-500 transition-transform duration-300"
          id="icon-{{ loop.index }}"
        ></i>
      </div>

      <!-- Subtopics Dropdown -->
      <div
        id="dropdown-{{ loop.index }}"
        class="hidden mt-4 transition-all duration-300 ease-in-out"
      >
        <div
          class="bg-purple-50 rounded-xl p-4 space-y-3 border border-purple-200"
        >
          {% for subtopic, link in subtopics.items() %} {% if link %}
          <a
            href="{{ link }}"
            target="_blank"
            class="block px-4 py-2 rounded-lg bg-white hover:bg-purple-100 text-purple-700 font-medium shadow transition"
          >
            {{ subtopic }}
          </a>
          {% else %}
          <span
            class="block px-4 py-2 rounded-lg bg-gray-100 text-gray-500 font-medium shadow cursor-not-allowed"
          >
            {{ subtopic }} (Coming Soon)
          </span>
          {% endif %} {% endfor %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- JavaScript to Toggle Dropdowns -->
<script>
  function toggleDropdown(index) {
    const dropdown = document.getElementById(`dropdown-${index}`);
    const icon = document.getElementById(`icon-${index}`);

    // Close all other dropdowns
    document.querySelectorAll('[id^="dropdown-"]').forEach((el) => {
      if (el.id !== `dropdown-${index}`) el.classList.add("hidden");
    });
    document.querySelectorAll('[id^="icon-"]').forEach((el) => {
      if (el.id !== `icon-${index}`) el.classList.remove("rotate-180");
    });

    // Toggle current dropdown
    dropdown.classList.toggle("hidden");
    icon.classList.toggle("rotate-180");
  }
</script>
{% endblock %}
