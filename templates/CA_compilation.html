{% extends "base.html" %} {% block title %}{{ period|title }} Current Affairs -
UPSC Aspirant{% endblock %} {% block content %}
<div class="bg-gray-100 min-h-screen">
  <main class="container mx-auto px-4 py-6">
    <!-- Header -->
    <div
      class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6"
    >
      <h1 class="text-2xl font-bold text-gray-800">
        {{ period|title }} Current Affairs Compilation
      </h1>

      <div class="flex gap-2">
        <a
          href="{{ url_for('current_affairs') }}"
          class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 transition-colors flex items-center gap-2"
        >
          <i class="fas fa-arrow-left"></i>
          <span>Back</span>
        </a>

        <button
          id="downloadBtn"
          class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors flex items-center gap-2"
        >
          <i class="fas fa-download"></i>
          <span>Download PDF</span>
        </button>
      </div>
    </div>

    <!-- Time Period Selection -->
    <div class="bg-white rounded-lg shadow-md p-4 mb-6">
      <div class="flex flex-wrap gap-2">
        <a
          href="{{ url_for('CA_compilation', period='weekly') }}"
          class="px-4 py-2 rounded-md text-sm font-medium transition-colors {{ 'bg-blue-600 text-white' if period == 'weekly' else 'bg-gray-100 text-gray-700 hover:bg-gray-200' }}"
        >
          Weekly
        </a>
        <a
          href="{{ url_for('CA_compilation', period='monthly') }}"
          class="px-4 py-2 rounded-md text-sm font-medium transition-colors {{ 'bg-blue-600 text-white' if period == 'monthly' else 'bg-gray-100 text-gray-700 hover:bg-gray-200' }}"
        >
          Monthly
        </a>
        <a
          href="{{ url_for('CA_compilation', period='yearly') }}"
          class="px-4 py-2 rounded-md text-sm font-medium transition-colors {{ 'bg-blue-600 text-white' if period == 'yearly' else 'bg-gray-100 text-gray-700 hover:bg-gray-200' }}"
        >
          Yearly
        </a>
      </div>
    </div>

    <!-- Content -->
    <div class="bg-white rounded-lg shadow-md p-6" id="compilationContent">
      <!-- Date Range Info -->
      <div class="border-b pb-4 mb-6">
        <h2 class="text-xl font-semibold text-gray-800">
          {% if period == 'weekly' %} Current Affairs: {{ start_date }} to {{
          end_date }} {% elif period == 'monthly' %} Current Affairs: {{
          month_name }} {{ year }} {% else %} Current Affairs: Year {{ year }}
          {% endif %}
        </h2>
        <p class="text-gray-600 mt-2">
          A comprehensive compilation of important news articles for UPSC
          aspirants.
        </p>
      </div>

      <!-- Table of Contents -->
      <div class="mb-8">
        <h3 class="text-lg font-semibold mb-4">Table of Contents</h3>
        <ol class="list-decimal pl-6 space-y-2">
          {% for category in categories %}
          <li>
            <a
              href="#{{ category|replace(' ', '-')|lower }}"
              class="text-blue-600 hover:underline"
            >
              {{ category|title }}
            </a>
          </li>
          {% endfor %}
        </ol>
      </div>

      <!-- Category Sections -->
      {% for category in categories %}
      <section id="{{ category|replace(' ', '-')|lower }}" class="mb-10">
        <h3 class="text-xl font-semibold mb-4 pb-2 border-b">
          {{ category|title }}
        </h3>

        {% if compilation_data[category]|length > 0 %} {% for article in
        compilation_data[category] %}
        <div class="mb-6 pb-6 border-b border-gray-100 last:border-0">
          <h4 class="text-lg font-medium mb-2">{{ article.title }}</h4>
          <p class="text-gray-600 mb-3">{{ article.description }}</p>

          {% if article.key_points %}
          <div class="bg-gray-50 p-4 rounded-md mb-3">
            <h5 class="font-medium mb-2">Key Points:</h5>
            <ul class="list-disc pl-5 space-y-1">
              {% for point in article.key_points %}
              <li>{{ point }}</li>
              {% endfor %}
            </ul>
          </div>
          {% endif %}

          <div class="flex justify-between items-center">
            <a
              href="{{ article.url }}"
              target="_blank"
              class="text-blue-600 hover:underline flex items-center gap-1"
            >
              Read Original Article
              <i class="fas fa-external-link-alt text-xs"></i>
            </a>
            <span class="text-sm text-gray-500"
              >{{ article.publishedAt.split('T')[0] if article.publishedAt else
              '' }}</span
            >
          </div>
        </div>
        {% endfor %} {% else %}
        <p class="text-gray-600 italic">
          No articles available for this category in the selected time period.
        </p>
        {% endif %}
      </section>
      {% endfor %}
    </div>
  </main>
</div>

<script>
  // Print functionality
  document.getElementById("printBtn").addEventListener("click", function () {
    window.print();
  });

  // Download as PDF functionality
  document.getElementById("downloadBtn").addEventListener("click", function () {
    // You would typically implement this with a server-side PDF generation
    // For now, we'll just show a notification that this feature is coming soon
    showNotification("PDF download feature coming soon!", "info");

    // Alternatively, you could use a client-side PDF generation library like jsPDF
    // but that would require additional setup
  });

  // Notification function
  function showNotification(message, type = "info") {
    // Create notification element
    const notification = document.createElement("div");

    // Set classes based on type
    let bgColor = "bg-blue-500";
    let icon = "fa-info-circle";

    if (type === "success") {
      bgColor = "bg-green-500";
      icon = "fa-check-circle";
    } else if (type === "error") {
      bgColor = "bg-red-500";
      icon = "fa-exclamation-circle";
    }

    // Set notification content and styling
    notification.className = `fixed bottom-4 right-4 ${bgColor} text-white px-4 py-3 rounded-md shadow-lg flex items-center transition-opacity duration-300 z-50`;
    notification.innerHTML = `
      <i class="fas ${icon} mr-2"></i>
      <span>${message}</span>
    `;

    // Add to document
    document.body.appendChild(notification);

    // Remove after 3 seconds
    setTimeout(() => {
      notification.style.opacity = "0";
      setTimeout(() => {
        document.body.removeChild(notification);
      }, 300);
    }, 3000);
  }

  // Smooth scrolling for table of contents
  document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();

      document.querySelector(this.getAttribute("href")).scrollIntoView({
        behavior: "smooth",
      });
    });
  });
</script>
{% endblock %}

<button
  id="printBtn"
  class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors flex items-center gap-2"
>
  <i class="fas fa-print"></i>
  <span>Print</span>
</button>
